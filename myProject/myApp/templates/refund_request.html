{% extends 'base.html' %}

{% block content %}
<section class="section">
    <div class="container">
        <h1 class="page-title">Request Refund</h1>
        
        <div class="refund-container">
            <div class="ticket-info-card">
                <h2>Ticket Information</h2>
                <p><strong>Ticket ID:</strong> {{ ticket.ticket_id }}</p>
                <p><strong>Passenger:</strong> {{ ticket.passenger_name }}</p>
                <p><strong>Flight:</strong> {{ ticket.flight.airline }} {{ ticket.flight.flight_number }}</p>
                <p><strong>Route:</strong> {{ ticket.flight.origin }} → {{ ticket.flight.destination }}</p>
                <p><strong>Departure:</strong> {{ ticket.flight.departure_date }} at {{ ticket.flight.departure_time }}</p>
                <p><strong>Seat:</strong> {{ ticket.seat_number }} ({{ ticket.get_seat_class_display }})</p>
                <p><strong>Original Price:</strong> ${{ ticket.flight.price }}</p>
            </div>
            
            <div class="refund-details-card">
                <h2>Refund Details</h2>
                <div class="refund-calculation">
                    <div class="calc-row">
                        <span>Original Ticket Price:</span>
                        <strong>${{ ticket.flight.price }}</strong>
                    </div>
                    <div class="calc-row cancellation-fee">
                        <span>Cancellation Fee (20%):</span>
                        <strong>-${{ cancellation_fee|floatformat:2 }}</strong>
                    </div>
                    <div class="calc-row total">
                        <span>Refund Amount:</span>
                        <strong class="refund-amount">${{ refund_amount|floatformat:2 }}</strong>
                    </div>
                </div>
                
                <div class="refund-policy">
                    <h3>Refund Policy</h3>
                    <ul>
                        <li>A 20% cancellation fee will be deducted from your ticket price</li>
                        <li>Refund will be processed within 5-7 business days</li>
                        <li>Amount will be credited to your original payment method</li>
                        <li>Your seat will be released back to available inventory</li>
                        <li>This action cannot be undone</li>
                    </ul>
                </div>
                
                <form method="POST" class="refund-form">
                    {% csrf_token %}
                    <div class="form-actions">
                        <button type="submit" class="btn-danger" onclick="return confirm('Are you sure you want to cancel this ticket? This action cannot be undone.')">
                            Confirm Refund Request
                        </button>
                        <a href="{% url 'profile' %}" class="btn-outline">Cancel</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<style>
.refund-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
    margin-top: 30px;
}

.ticket-info-card, .refund-details-card {
    background: white;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.ticket-info-card p {
    margin: 10px 0;
    padding: 10px;
    background: #f8f9fa;
    border-radius: 5px;
}

.refund-calculation {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    margin: 20px 0;
}

.calc-row {
    display: flex;
    justify-content: space-between;
    padding: 10px 0;
    border-bottom: 1px solid #dee2e6;
}

.calc-row.cancellation-fee {
    color: #dc3545;
}

.calc-row.total {
    border-bottom: none;
    border-top: 2px solid #333;
    margin-top: 10px;
    padding-top: 15px;
    font-size: 1.2em;
}

.refund-amount {
    color: #28a745;
    font-size: 1.3em;
}

.refund-policy {
    margin: 20px 0;
}

.refund-policy h3 {
    margin-bottom: 15px;
    color: #333;
}

.refund-policy ul {
    list-style: none;
    padding: 0;
}

.refund-policy li {
    padding: 8px 0;
    padding-left: 25px;
    position: relative;
}

.refund-policy li:before {
    content: "•";
    position: absolute;
    left: 0;
    color: #007bff;
    font-weight: bold;
}

.form-actions {
    display: flex;
    gap: 15px;
    margin-top: 20px;
}

.btn-danger {
    background: #dc3545;
    color: white;
    padding: 12px 30px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
    transition: background 0.3s;
}

.btn-danger:hover {
    background: #c82333;
}

@media (max-width: 768px) {
    .refund-container {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}
